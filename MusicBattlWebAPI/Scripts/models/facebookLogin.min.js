define([],function(){return Backbone.Model.extend({initialize:function(){this.loadedUser=!1},getLogedUser:function(){var n=this;FB.getLoginStatus(function(t){t.status==="connected"&&n.fetchData()})},login:function(){var n=this;FB.getLoginStatus(function(t){FB.Event.subscribe("auth.authResponseChange",function(t){t.status==="connected"&&n.getLogedUser()});t.status==="connected"?n.fetchData():FB.login()})},logout:function(n){this.url="/api/Account/SignOut/{0}".format(n);this.save(this.usuario,{success:$.proxy(this.onLogoutReturn,this),error:$.proxy(this.onModelError,this)})},onLogoutReturn:function(){this.logoutFaceBook()},onLoginReturn:function(n){eventHandler.trigger("onLoginReturn",n)},onModelError:function(n,t){var i="",r="";i=t.statusText;r=t.responseText;eventHandler.trigger("onLoginError",{});musicBattlUtils.showError(r,i)},logoutFaceBook:function(){FB.getLoginStatus(function(n){n.status==="connected"&&FB.logout(function(){eventHandler.trigger("onLogoutReturn")})})},fetchData:function(){var t,n=this;FB.api("/me",function(i){t={};t.name=i.name;t.id=0;t.customId=i.id;t.picture="https://graph.facebook.com/{0}/picture".format(i.username);t.gender=i.gender.replace(/male/,"M").replace(/Female/,"F");t.type=musicBattlUtils.enumLoginType.facebook;FB.Event.unsubscribe("auth.authResponseChange",n);n.loadedUser||(n.loadedUser=!0,n.url="/api/Account/SignIn/{0}".format(i.id),n.save({},{success:$.proxy(n.onLoginReturn,n,t),error:$.proxy(n.onModelError,n)}))})}})});
//# sourceMappingURL=facebookLogin.min.js.map