define([],function(){return Backbone.Model.extend({initialize:function(){this.returnedUser={};this.loadedUser=!1},getLogedUser:function(){var n,t=this;gapi.client.load("plus","v1",function(){var i=gapi.client.plus.people.get({userId:"me"});i.execute(function(i){n={};n.name=i.displayName;n.id=0;n.customId=i.id;n.gender=i.gender.replace(/male/,"M").replace(/Female/,"F");n.picture=i.image.url.replace(/\?sz=50/,"?sz=60");n.type=musicBattlUtils.enumLoginType.googleplus;t.returnedUser=n;t.loadedUser||(t.loadedUser=!0,t.url="/api/Account/SignIn/{0}".format(i.id),t.save({},{success:$.proxy(t.onLoginReturn,t,n),error:$.proxy(t.onModelError,t)}))})})},login:function(){var t=this,n;window.signinCallback=function(n){n.error||t.getLogedUser(n.access_token)};n={callback:signinCallback,clientid:"785627913508.apps.googleusercontent.com",cookiepolicy:"single_host_origin",requestvisibleactions:"http://schemas.google.com/AddActivity",scope:"https://www.googleapis.com/auth/plus.login"};gapi.auth.signIn(n)},logout:function(n){this.url="/api/Account/SignOut/{0}".format(n);this.save(this.usuario,{success:$.proxy(this.onLogoutReturn,this),error:$.proxy(this.onModelError,this)})},onLogoutReturn:function(){eventHandler.trigger("onLogoutReturn")},onLoginReturn:function(n,t){n.id=t.changed.UserId;n.profileId=t.changed.ProfileId;eventHandler.trigger("onLoginReturn",n)},onModelError:function(n,t){var i="",r="";i=t.statusText;r=t.responseText;eventHandler.trigger("onLoginError",{});musicBattlUtils.showError(r,i)},fetchData:function(){}})});